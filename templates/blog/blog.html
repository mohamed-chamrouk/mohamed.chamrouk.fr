{% extends 'base.html' %}

{% block content %}
{% if current_user.is_authenticated %}
<p>&raquo; <a class="action" href="{{ url_for('create') }}">Nouveau post</a></p>
{% endif %}
{% for post in posts %}
<article class="h-entry">
  <h1 class="p-name">
    <a class="u-url" href="/blog/{{post['id']}}">{{ post['title'] }}</a>
  </h1>
  <p>
    par <a class="p-author h-card">{{ post['name'] }}</a>
    le <a class="u-url">
      <time class="dt-published" datetime="{{ post['created'].strftime('%Y-%m-%d %H:%M') }}">
        {{ post['created'].strftime('%d %b %Y à %H:%M') }}
      </time>
    </a>
  </p>
  <div class="e-content">
    <p>{{ markdown(post['body'], extensions=['fenced_code'])|safe }}</p>
  </div>
  {% if (current_user.get_id() | int) == post['author_id'] %}
  <a class="dropbtn-invert" href="{{ url_for('update', id=post['id']) }}">Editer</a>
  {% endif %}
</article>
{% if not loop.last %}
<hr>
{% endif %}
{% endfor %}
{% if total_page > 1 %}
<div style="padding-top: 50px">
  {% if current_page > 1 %}
  <a href="?page={{ current_page-1 }}"> Page précédente</a>
  {% endif %}
  Page {{ current_page }} sur {{ total_page}}.
  {% if current_page != total_page %}
  <a href="?page={{ current_page+1 }}"> Page suivante </a>
  {% endif %}
</div>
{% endif %}
{% endblock %}
